-- Function to raise the turtle 3 blocks up
function riseUp(levels)
    for i = 1, levels do
        turtle.up()
    end
end

-- Function to determine facing direction
function determineDirection()
    local startX, startY, startZ = gps.locate(5)
    print("Initial position: X=" .. startX .. ", Y=" .. startY .. ", Z=" .. startZ)

    -- Move forward and check coordinates
    turtle.forward()
    local newX, newY, newZ = gps.locate(5)
    print("Position after moving forward: X=" .. newX .. ", Y=" .. newY .. ", Z=" .. newZ)

    -- Determine initial facing direction
    local initialFacing = ""
    if newX > startX then
        initialFacing = "East"
    elseif newX < startX then
        initialFacing = "West"
    elseif newZ > startZ then
        initialFacing = "South"
    elseif newZ < startZ then
        initialFacing = "North"
    end
    print("Initially facing " .. initialFacing)

    -- Move back to original position
    turtle.back()

    -- Turn left and move forward to check again
    turtle.turnLeft()
    print("Turned left.")
    turtle.forward()
    local checkX, _, checkZ = gps.locate(5)
    turtle.back()

    -- Determine new facing direction
    local newFacing = ""
    if checkX > newX then
        newFacing = "East"
    elseif checkX < newX then
        newFacing = "West"
    elseif checkZ > newZ then
        newFacing = "South"
    elseif checkZ < newZ then
        newFacing = "North"
    end
    print("After turning left, now facing " .. newFacing)

    turtle.turnRight() -- Realign to original facing before the check
end

-- Main execution
riseUp(3)
determineDirection()
